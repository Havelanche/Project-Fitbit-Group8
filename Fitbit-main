from data_processing import load_data, get_unique_users
from visualization import plot_distance_distribution, plot_workout, plot_LRM, calories_burned_per_day
from analysis import classify_user, linear_regression
from database import connect_db, verify_total_steps

def main():
    DATA_FILE = "daily_activity.csv"
    DB_NAME = "fitbit_database.db"

    # Load data
    df = load_data(DATA_FILE)

    # Get unique users
    unique_users = get_unique_users(df, 'TotalSteps')
    print(f"Number of unique users: {df['Id'].nunique()} \n")

    # Visualization
    plot_distance_distribution(df)
    plot_workout(df)

    # Linear regression model
    model = linear_regression(df)
    print(model.summary())

    # Calories burned per day (example user)
    user_id_test = df['Id'].iloc[0]  
    calories_burned_per_day(df, user_id=user_id_test, start_date="2016-03-01", end_date="2016-03-30")

    # Regression plot for a user
    plot_LRM(df, user_id=user_id_test)

    # Classify users based on activity
    user_classes = classify_user(df)
    print(user_classes)

    # Database verification
    connection = connect_db(DB_NAME)
    verify_total_steps(df, connection)
    connection.close()

if __name__ == '__main__':
    main()
